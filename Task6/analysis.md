# Анализ подозрительных событий в журнале аудита

## Событие 1: Получение доступа к секретным данным

- **Учетная запись**: 'system:serviceaccount:kube-system:daemon-set-controller'
- **Пространство имен**: 'kube-system'
- **Суть инцидента**: Обнаружена попытка доступа к секретным данным в системном пространстве имен от имени сервисного
  аккаунта мониторинга
- **Меры устранения**: Исключить назначение ClusterRole с доступом к secrets или ограничить права Role в пределах
  secure-ops без создания clusterrolebinding

## Событие 2: Создание привилегированных контейнеров

- **Учетная запись**: 'system:serviceaccount:kube-system:daemon-set-controller'
- **Имя ресурса**: 'privileged-pod'
- **Суть инцидента**: Зафиксировано создание привилегированного Pod с повышенными правами доступа
- **Меры устранения**: Ограничить права на создание pods с привилегированным доступом

## Событие 3: Выполнение команд в системных компонентах

- **Учетная запись**: 'system:serviceaccount:kube-system:daemon-set-controller'
- **Пространство имен**: 'kube-system'
- **Имя ресурса**: 'coredns'
- **Суть инцидента**: Обнаружено выполнение команд внутри системного компонента CoreDNS
- **Меры устранения**: Исключить ресурс pods/exec из Role, убедиться в отсутствии прав create на pods/exec в kube-system

## Событие 4: Удаление конфигурации аудита

- **Учетная запись**: 'system:serviceaccount:kube-system:daemon-set-controller'
- **Суть инцидента**: Зафиксировано удаление файла политики аудита
- **Меры устранения**: Обеспечить отсутствие прав delete на объекты ConfigMap, Policy и CustomResource у сервисного
  аккаунта

## Событие 5: Создание привилегированных привязок

- **Учетная запись**: 'system:serviceaccount:kube-system:daemon-set-controller'
- **Имя ресурса**: 'escalate-binding'
- **Суть инцидента**: Создание RoleBinding с правами полного администратора кластера
- **Меры устранения**: Заблокировать возможность создания RoleBinding или запретить указание cluster-admin в
  roleRef.name

## Итоговые рекомендации:

- Ужесточение политики RBAC для сервисного аккаунта мониторинга
- Изоляция прав доступа в пространстве имен secure-ops
- Исключение из Role/RoleBinding доступа к ресурсам: secrets, pods/exec, privileged контейнеры, rolebindings с
  cluster-admin
